<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>Dependency injection or IOC | tsoa</title>
    <meta name="generator" content="VuePress 1.8.2">
    
    <meta name="description" content="">
    
    <link rel="preload" href="/docs/assets/css/0.styles.8095d402.css" as="style"><link rel="preload" href="/docs/assets/js/app.172ac33a.js" as="script"><link rel="preload" href="/docs/assets/js/2.80be49a5.js" as="script"><link rel="preload" href="/docs/assets/js/14.361d3799.js" as="script"><link rel="preload" href="/docs/assets/js/5.854c0520.js" as="script"><link rel="prefetch" href="/docs/assets/js/10.006bbd57.js"><link rel="prefetch" href="/docs/assets/js/11.b613c56a.js"><link rel="prefetch" href="/docs/assets/js/12.357d0ba5.js"><link rel="prefetch" href="/docs/assets/js/13.8d1e6983.js"><link rel="prefetch" href="/docs/assets/js/15.ee24ce00.js"><link rel="prefetch" href="/docs/assets/js/16.46d23f66.js"><link rel="prefetch" href="/docs/assets/js/17.002f77d1.js"><link rel="prefetch" href="/docs/assets/js/18.51577473.js"><link rel="prefetch" href="/docs/assets/js/19.ad8ed279.js"><link rel="prefetch" href="/docs/assets/js/20.a59c17cf.js"><link rel="prefetch" href="/docs/assets/js/21.e9b1560f.js"><link rel="prefetch" href="/docs/assets/js/22.768f5308.js"><link rel="prefetch" href="/docs/assets/js/23.cc6050e2.js"><link rel="prefetch" href="/docs/assets/js/24.054f5663.js"><link rel="prefetch" href="/docs/assets/js/25.26ede546.js"><link rel="prefetch" href="/docs/assets/js/26.81f7206a.js"><link rel="prefetch" href="/docs/assets/js/3.39377a9e.js"><link rel="prefetch" href="/docs/assets/js/4.767283c4.js"><link rel="prefetch" href="/docs/assets/js/6.e8445b13.js"><link rel="prefetch" href="/docs/assets/js/7.3f8df6cc.js"><link rel="prefetch" href="/docs/assets/js/8.98a69bdd.js"><link rel="prefetch" href="/docs/assets/js/9.5f39e1cf.js">
    <link rel="stylesheet" href="/docs/assets/css/0.styles.8095d402.css">
  </head>
  <body>
    <div id="app" data-server-rendered="true"><div class="theme-container"><header class="navbar"><div class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div> <a href="/docs/" class="home-link router-link-active"><!----> <span class="site-name">tsoa</span></a> <div class="links"><div class="search-box"><input aria-label="Search" autocomplete="off" spellcheck="false" value=""> <!----></div> <nav class="nav-links can-hide"><div class="nav-item"><a href="/docs/" class="nav-link">
  Home
</a></div><div class="nav-item"><a href="/docs/introduction.html" class="nav-link">
  Guides
</a></div><div class="nav-item"><a href="https://tsoa-community.github.io/reference/index.html" target="_blank" rel="noopener noreferrer" class="nav-link external">
  API Reference
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></div><div class="nav-item"><a href="https://github.com/lukeautry/tsoa" target="_blank" rel="noopener noreferrer" class="nav-link external">
  GitHub
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></div> <!----></nav></div></header> <div class="sidebar-mask"></div> <aside class="sidebar"><nav class="nav-links"><div class="nav-item"><a href="/docs/" class="nav-link">
  Home
</a></div><div class="nav-item"><a href="/docs/introduction.html" class="nav-link">
  Guides
</a></div><div class="nav-item"><a href="https://tsoa-community.github.io/reference/index.html" target="_blank" rel="noopener noreferrer" class="nav-link external">
  API Reference
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></div><div class="nav-item"><a href="https://github.com/lukeautry/tsoa" target="_blank" rel="noopener noreferrer" class="nav-link external">
  GitHub
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></div> <!----></nav>  <ul class="sidebar-links"><li><a href="/docs/introduction.html" class="sidebar-link">Introduction</a></li><li><a href="/docs/getting-started.html" class="sidebar-link">Getting started</a></li><li><section class="sidebar-group depth-0"><p class="sidebar-heading open"><span>Guides</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/docs/generating.html" class="sidebar-link">Generating Routes and OAS</a></li><li><a href="/docs/live-reloading.html" class="sidebar-link">Live reloading</a></li><li><a href="/docs/error-handling.html" class="sidebar-link">Error Handling</a></li><li><a href="/docs/descriptions.html" class="sidebar-link">Descriptions</a></li><li><a href="/docs/examples.html" class="sidebar-link">Examples</a></li><li><a href="/docs/annotations.html" class="sidebar-link">JSON Schema / tsoa keyword annotations</a></li><li><a href="/docs/di.html" aria-current="page" class="active sidebar-link">Dependency injection or IOC</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/docs/di.html#ioc-module" class="sidebar-link">IoC Module</a></li><li class="sidebar-sub-header"><a href="/docs/di.html#inversifyjs" class="sidebar-link">InversifyJS</a></li><li class="sidebar-sub-header"><a href="/docs/di.html#tsyringe" class="sidebar-link">TSyringe</a></li><li class="sidebar-sub-header"><a href="/docs/di.html#typescript-ioc" class="sidebar-link">typescript-ioc</a></li></ul></li><li><a href="/docs/authentication.html" class="sidebar-link">Authentication</a></li><li><a href="/docs/decorators.html" class="sidebar-link">Decorators</a></li></ul></section></li><li><a href="/docs/faq.html" class="sidebar-link">FAQ</a></li><li><section class="sidebar-group depth-0"><p class="sidebar-heading"><span>Advanced Guides</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/docs/file-upload.html" class="sidebar-link">Uploading files</a></li><li><a href="/docs/path-mapping.html" class="sidebar-link">Path mapping</a></li><li><a href="/docs/templates.html" class="sidebar-link">Overriding route template</a></li><li><a href="/docs/routes.html" class="sidebar-link">Consuming generated routes</a></li></ul></section></li><li><a href="/docs/upgrading.html" class="sidebar-link">Upgrading from tsoa 2.5</a></li></ul> </aside> <main class="page"> <div class="theme-default-content content__default"><h1 id="dependency-injection-or-ioc"><a href="#dependency-injection-or-ioc" class="header-anchor">#</a> Dependency injection or IOC</h1> <p>By default all the controllers are created by the auto-generated routes template using an empty default constructor.
If you want to use dependency injection and let the DI-framework handle the creation of your controllers, we need set up an IoC Module tsoa can call.</p> <p>To tell <code>tsoa</code> to use your DI-container you have to reference your module exporting the DI-container in the <a href="https://github.com/lukeautry/tsoa/blob/master/src/config.ts" target="_blank" rel="noopener noreferrer">config<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a> file (e.g. <code>tsoa.json</code>):</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token punctuation">{</span>
  <span class="token string">&quot;entryFile&quot;</span><span class="token operator">:</span> <span class="token string">&quot;...&quot;</span><span class="token punctuation">,</span>
  <span class="token string">&quot;spec&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span>
    <span class="token operator">...</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
  <span class="token string">&quot;routes&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span>
    <span class="token string">&quot;routesDir&quot;</span><span class="token operator">:</span> <span class="token string">&quot;...&quot;</span><span class="token punctuation">,</span>
    <span class="token string">&quot;middleware&quot;</span><span class="token operator">:</span> <span class="token string">&quot;...&quot;</span><span class="token punctuation">,</span>
    <span class="token string">&quot;iocModule&quot;</span><span class="token operator">:</span> <span class="token string">&quot;src/ioc&quot;</span><span class="token punctuation">,</span>
    <span class="token operator">...</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre></div><h2 id="ioc-module"><a href="#ioc-module" class="header-anchor">#</a> IoC Module</h2> <p>Now you can create a module that exports either a container or a function as <code>iocContainer</code>.</p> <p>Containers must conform to the following interface.</p> <div class="language-ts extra-class"><pre class="language-ts"><code><span class="token keyword">interface</span> <span class="token class-name">IocContainer</span> <span class="token punctuation">{</span>
  <span class="token generic-function"><span class="token function">get</span><span class="token generic class-name"><span class="token operator">&lt;</span><span class="token constant">T</span><span class="token operator">&gt;</span></span></span><span class="token punctuation">(</span>controller<span class="token operator">:</span> <span class="token punctuation">{</span> prototype<span class="token operator">:</span> <span class="token constant">T</span> <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token operator">:</span> <span class="token constant">T</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre></div><p>Functions must conform to the following signature, where <code>request</code> is your web framework's request object.</p> <div class="language-ts extra-class"><pre class="language-ts"><code><span class="token keyword">type</span> <span class="token class-name">IocContainerFactory</span> <span class="token operator">=</span> <span class="token punctuation">(</span>request<span class="token operator">:</span> <span class="token builtin">unknown</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> IocContainer<span class="token punctuation">;</span>
</code></pre></div><h3 id="example"><a href="#example" class="header-anchor">#</a> Example</h3> <div class="language-ts extra-class"><pre class="language-ts"><code><span class="token comment">// src/ioc.ts</span>
<span class="token keyword">import</span> <span class="token punctuation">{</span> IocContainer<span class="token punctuation">,</span> IocContainerFactory <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">&quot;@tsoa/runtime&quot;</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token punctuation">{</span> Container <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">&quot;di-package&quot;</span><span class="token punctuation">;</span>

<span class="token comment">// Assign a container to `iocContainer`.</span>
<span class="token keyword">const</span> iocContainer <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Container</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment">// Or assign a function with to `iocContainer`.</span>
<span class="token keyword">const</span> iocContainer<span class="token operator">:</span> <span class="token function-variable function">IocContainerFactory</span> <span class="token operator">=</span> <span class="token keyword">function</span> <span class="token punctuation">(</span>
  request<span class="token operator">:</span> Request
<span class="token punctuation">)</span><span class="token operator">:</span> IocContainer <span class="token punctuation">{</span>
  <span class="token keyword">const</span> container <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Container</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token function">container</span><span class="token punctuation">.</span><span class="token function">bind</span><span class="token punctuation">(</span>request<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token keyword">return</span> container<span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>

<span class="token comment">// export according to convention</span>
<span class="token keyword">export</span> <span class="token punctuation">{</span> iocContainer <span class="token punctuation">}</span><span class="token punctuation">;</span>
</code></pre></div><div class="custom-block tip"><p class="custom-block-title">TIP</p> <p>If you want to use a DI framework other than the examples below, adding it isn't hard.
If you set an iocModule, tsoa will call this module (to get a <code>FooController</code>) with:</p> <div class="language-ts extra-class"><pre class="language-ts"><code><span class="token keyword">import</span> <span class="token punctuation">{</span> iocContainer <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">&quot;./the/path/to/the/module/from/tsoa.json&quot;</span><span class="token punctuation">;</span>

iocContainer<span class="token punctuation">.</span><span class="token generic-function"><span class="token function">get</span><span class="token generic class-name"><span class="token operator">&lt;</span>FooController<span class="token operator">&gt;</span></span></span><span class="token punctuation">(</span>FooController<span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><p>If you wrap your DI's API or even a ControllerFactory to accept this call and respond with a FooController, it'll work.</p></div> <h2 id="inversifyjs"><a href="#inversifyjs" class="header-anchor">#</a> InversifyJS</h2> <p>Here is some example code to setup the container and your controller with inversify.js.
Usually, you'll have to tell inversify how to create your controller, but since this is not supposed to cover inversify,
we'll just refer to their <a href="http://inversify.io/" target="_blank" rel="noopener noreferrer">docs<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a>.
For convenience, we will use inversify-binding-controllers here, which makes it very simple to tell inversify how to create tsoa controllers.
More information can be found <a href="https://github.com/inversify/inversify-binding-decorators" target="_blank" rel="noopener noreferrer">here<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a>.</p> <div class="language-ts extra-class"><pre class="language-ts"><code><span class="token comment">// src/ioc.ts</span>
<span class="token keyword">import</span> <span class="token punctuation">{</span> Container<span class="token punctuation">,</span> decorate<span class="token punctuation">,</span> injectable <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">&quot;inversify&quot;</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token punctuation">{</span> buildProviderModule <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">&quot;inversify-binding-decorators&quot;</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token punctuation">{</span> Controller <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">&quot;tsoa&quot;</span><span class="token punctuation">;</span>

<span class="token comment">// Create a new container tsoa can use</span>
<span class="token keyword">const</span> iocContainer <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Container</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token function">decorate</span><span class="token punctuation">(</span><span class="token function">injectable</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> Controller<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// Makes tsoa's Controller injectable</span>

<span class="token comment">// make inversify aware of inversify-binding-decorators</span>
iocContainer<span class="token punctuation">.</span><span class="token function">load</span><span class="token punctuation">(</span><span class="token function">buildProviderModule</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment">// export according to convention</span>
<span class="token keyword">export</span> <span class="token punctuation">{</span> iocContainer <span class="token punctuation">}</span><span class="token punctuation">;</span>
</code></pre></div><p>We usually don't want to create a new controller instance for every call, so let's create a convenience wrapper around <a href="https://github.com/inversify/inversify-binding-decorators#fluent-binding-decorator" target="_blank" rel="noopener noreferrer"><code>@fluentProvide()</code><span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></p> <div class="custom-block danger"><p class="custom-block-title">WARNING</p> <p>If you rely on controller state (for example, because you're using <code>this.setHeaders</code> inherited by <a href="https://tsoa-community.github.io/reference/classes/_tsoa_runtime.controller-1.html" target="_blank" rel="noopener noreferrer">Controller<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a>), you need to inject a new Controller for every request.
Instead of <code>@provideSingleton</code>, please make sure to use <code>@fluentProvide</code> directly (which is the default way to <code>fluentProvide(identifier).inTransientScope()</code>).</p></div> <div class="language-ts extra-class"><pre class="language-ts"><code><span class="token comment">// src/util/provideSingleton.ts</span>
<span class="token keyword">import</span> <span class="token punctuation">{</span> fluentProvide <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">&quot;inversify-binding-decorators&quot;</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token punctuation">{</span> <span class="token keyword">interface</span>s <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">&quot;inversify&quot;</span><span class="token punctuation">;</span>

<span class="token keyword">export</span> <span class="token keyword">const</span> <span class="token function-variable function">provideSingleton</span> <span class="token operator">=</span> <span class="token keyword">function</span> <span class="token operator">&lt;</span><span class="token constant">T</span><span class="token operator">&gt;</span><span class="token punctuation">(</span>
  identifier<span class="token operator">:</span> <span class="token keyword">interface</span>s<span class="token punctuation">.</span>ServiceIdentifier<span class="token operator">&lt;</span><span class="token constant">T</span><span class="token operator">&gt;</span>
<span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">return</span> <span class="token function">fluentProvide</span><span class="token punctuation">(</span>identifier<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">inSingletonScope</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">done</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>
</code></pre></div><p>Now, in our controllers, we can use <code>@provideSingleton()</code></p> <div class="language-ts extra-class"><pre class="language-ts"><code><span class="token comment">// src/users/usersController.ts</span>
<span class="token keyword">import</span> <span class="token punctuation">{</span> Route <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">'tsoa'</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token punctuation">{</span> provideSingleton<span class="token punctuation">,</span> inject <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">'../inversify/ioc'</span><span class="token punctuation">;</span>

<span class="token decorator"><span class="token at operator">@</span><span class="token function">Route</span></span><span class="token punctuation">(</span><span class="token string">'foo'</span><span class="token punctuation">)</span>
<span class="token decorator"><span class="token at operator">@</span><span class="token function">provideSingleton</span></span><span class="token punctuation">(</span>FooController<span class="token punctuation">)</span>
<span class="token keyword">export</span> <span class="token keyword">class</span> <span class="token class-name">UsersController</span> <span class="token punctuation">{</span>
  <span class="token function">constructor</span><span class="token punctuation">(</span>
    <span class="token decorator"><span class="token at operator">@</span><span class="token function">inject</span></span><span class="token punctuation">(</span>FooService<span class="token punctuation">)</span> <span class="token keyword">private</span> fooService<span class="token operator">:</span> FooService
  <span class="token punctuation">)</span> <span class="token punctuation">{</span> <span class="token punctuation">}</span>
  <span class="token operator">...</span>
<span class="token punctuation">}</span>

<span class="token decorator"><span class="token at operator">@</span><span class="token function">provideSingleton</span></span><span class="token punctuation">(</span>FooService<span class="token punctuation">)</span> <span class="token comment">// or @provide(FooService)</span>
<span class="token keyword">export</span> <span class="token keyword">class</span> <span class="token class-name">FooService</span> <span class="token punctuation">{</span>
  <span class="token function">constructor</span><span class="token punctuation">(</span>
    <span class="token comment">// maybe even more dependencies to be injected...</span>
  <span class="token punctuation">)</span>
<span class="token punctuation">}</span>
</code></pre></div><h2 id="tsyringe"><a href="#tsyringe" class="header-anchor">#</a> TSyringe</h2> <p>Here's an example using <a href="https://github.com/microsoft/tsyringe" target="_blank" rel="noopener noreferrer">TSyringe<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a>.</p> <div class="language-ts extra-class"><pre class="language-ts"><code><span class="token comment">// src/lib/tsyringeTsoaIocContainer.ts</span>
<span class="token comment">// Target this file in your tsoa.json's &quot;iocModule&quot; property</span>

<span class="token keyword">import</span> <span class="token punctuation">{</span> IocContainer <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">'@tsoa/runtime'</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token punctuation">{</span> container <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">'tsyringe'</span><span class="token punctuation">;</span>

<span class="token keyword">export</span> <span class="token keyword">const</span> iocContainer<span class="token operator">:</span> IocContainer <span class="token operator">=</span> <span class="token punctuation">{</span>
  get<span class="token operator">:</span> <span class="token operator">&lt;</span><span class="token constant">T</span><span class="token operator">&gt;</span><span class="token punctuation">(</span>controller<span class="token operator">:</span> <span class="token punctuation">{</span> prototype<span class="token operator">:</span> <span class="token constant">T</span> <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token operator">:</span> <span class="token constant">T</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
    <span class="token keyword">return</span> container<span class="token punctuation">.</span><span class="token generic-function"><span class="token function">resolve</span><span class="token generic class-name"><span class="token operator">&lt;</span><span class="token constant">T</span><span class="token operator">&gt;</span></span></span><span class="token punctuation">(</span>controller <span class="token keyword">as</span> <span class="token builtin">never</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>
</code></pre></div><div class="language-ts extra-class"><pre class="language-ts"><code><span class="token comment">// src/services/FooService.ts</span>

<span class="token keyword">import</span> <span class="token punctuation">{</span> singleton <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">'tsyringe'</span><span class="token punctuation">;</span>
<span class="token comment">// ...</span>

<span class="token decorator"><span class="token at operator">@</span><span class="token function">singleton</span></span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token keyword">export</span> <span class="token keyword">class</span> <span class="token class-name">FooService</span> <span class="token punctuation">{</span>
  <span class="token comment">// ...</span>
<span class="token punctuation">}</span>
</code></pre></div><div class="language-ts extra-class"><pre class="language-ts"><code><span class="token comment">// src/controllers/FooController.ts</span>

<span class="token keyword">import</span> <span class="token punctuation">{</span> Controller<span class="token punctuation">,</span> Route <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">'tsoa'</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token punctuation">{</span> injectable <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">'tsyringe'</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token punctuation">{</span> FooService <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">'../services/FooService'</span><span class="token punctuation">;</span>
<span class="token comment">// ...</span>

<span class="token decorator"><span class="token at operator">@</span><span class="token function">injectable</span></span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token decorator"><span class="token at operator">@</span><span class="token function">Route</span></span><span class="token punctuation">(</span><span class="token string">'foo'</span><span class="token punctuation">)</span>
<span class="token keyword">export</span> <span class="token keyword">class</span> <span class="token class-name">FooController</span> <span class="token keyword">extends</span> <span class="token class-name">Controller</span> <span class="token punctuation">{</span>
  <span class="token function">constructor</span><span class="token punctuation">(</span><span class="token keyword">private</span> fooService<span class="token operator">:</span> FooService<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">super</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
  
  <span class="token comment">// ...</span>
<span class="token punctuation">}</span>
</code></pre></div><h2 id="typescript-ioc"><a href="#typescript-ioc" class="header-anchor">#</a> typescript-ioc</h2> <p>Here is some example code to setup the controller with <a href="https://github.com/thiagobustamante/typescript-ioc" target="_blank" rel="noopener noreferrer">typescript-ioc<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a>.</p> <p><code>./controllers/fooController.ts</code></p> <div class="language-ts extra-class"><pre class="language-ts"><code><span class="token keyword">import</span> <span class="token punctuation">{</span> Route <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">'tsoa'</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token punctuation">{</span> Inject<span class="token punctuation">,</span> Singleton <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">&quot;typescript-ioc&quot;</span><span class="token punctuation">;</span>

<span class="token decorator"><span class="token at operator">@</span><span class="token function">Route</span></span><span class="token punctuation">(</span><span class="token string">'foo'</span><span class="token punctuation">)</span>
<span class="token keyword">export</span> <span class="token keyword">class</span> <span class="token class-name">FooController</span> <span class="token punctuation">{</span>

  <span class="token decorator"><span class="token at operator">@</span><span class="token function">Inject</span></span>
  <span class="token keyword">private</span> fooService<span class="token operator">:</span> FooService
  <span class="token operator">...</span>

<span class="token punctuation">}</span>

<span class="token decorator"><span class="token at operator">@</span><span class="token function">Singleton</span></span>
<span class="token keyword">export</span> <span class="token keyword">class</span> <span class="token class-name">FooService</span> <span class="token punctuation">{</span>

<span class="token punctuation">}</span>
</code></pre></div><p>The controllers need to be included in the application in order to be linked.</p> <p><code>index.ts</code></p> <div class="language-ts extra-class"><pre class="language-ts"><code><span class="token keyword">import</span> <span class="token string">&quot;./controllers/fooController.ts&quot;</span>
<span class="token operator">...</span>

</code></pre></div></div> <footer class="page-edit"><!----> <!----></footer> <div class="page-nav"><p class="inner"><span class="prev">
      ←
      <a href="/docs/annotations.html" class="prev">
        JSON Schema / tsoa keyword annotations
      </a></span> <span class="next"><a href="/docs/authentication.html">
        Authentication
      </a>
      →
    </span></p></div> </main></div><div class="global-ui"><!----><!----></div></div>
    <script src="/docs/assets/js/app.172ac33a.js" defer></script><script src="/docs/assets/js/2.80be49a5.js" defer></script><script src="/docs/assets/js/14.361d3799.js" defer></script><script src="/docs/assets/js/5.854c0520.js" defer></script>
  </body>
</html>
